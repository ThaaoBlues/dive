<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='drive.css') }}">
    <script src="{{ url_for('static', filename='files_preview.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.js" integrity="sha512-YeeA/Qxn5hYdkukScTCNNOhTrv1C2RubAGButJ1rmgQwZf/HdRaCGl+JAVkqsqaNRaYNHdheiuKKuPf9mDcqKg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <title>Dive/Channel content</title>
</head>
<body>

    <div class="files-grid">
        <div>
            <button onclick="document.location.href = document.location.pathname+'?page='+'{% if c_chunk > 1 %}{{c_chunk-1}}{%else%}{{c_chunk}}{%endif%}'">Previous Page</button>
            <button onclick="document.location.href = document.location.pathname+'?page='+'{{c_chunk+1}}'">Next Page</button>
            <h3>Page : {{c_chunk}}</h3>
        </div>
        <table class="files-table">
            
            <tbody>
                <tr>
                    <th>Icon</th>
                    <th>File name</th>
                    <th>Upload date</th>
                    <th>File version</th>
                    <th>Action</th>
                </tr>
                {%for media in medias%}
                    <tr>
                        <td><img class="file-btn" width="50" height="50" src="{{ url_for('static', filename='file-earmark.svg') }}" onclick="window.location.href='{{media['media_url']}}'" a></td>
                        <td><a class="file-txt" href="{{media['media_url']}}">{{media["file_name"]}}</a></td>
                        <td><b>{{media["date"].replace(" 00:00:00","")}}</b></td>
                        <td style="text-align: center;"><b>{{media["version"]}}</b></td>
                        <td>
                            <form action="/edit/{{media['server_id']}}/{{media['channel_name']}}">
                                <input name="file_name" hidden value="{{media['file_name']}}">
                                <input name="file_url" hidden value="{{media['media_url']}}">
                                {%if media["media_url"].startswith("https://cdn.discordapp.com/")%}<button type="submit">Edit file</button>{%endif%}
                            </form>
                        </td>
                    </tr>
                {%endfor%}
            </tbody>

        </table>

        <h3>Due to a sea of same file being repeatedly sent more than 30 times, we're setting a version limit of 30 each 180 days.</h3>

    </div>

    <script>

        const socket = io();
        
        socket.on("notify",function(data){
            alert(data["msg"]);
        });

    </script>
</body>
</html>